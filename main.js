!function(){"use strict";function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var t=function(){function t(e){var n=e.data,r=e.handleImageClick,o=e.handleLikeClick,i=e.handleTrashClick,a=e.currentUserId,c=e.cardSelector;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this._name=n.name,this._link=n.link,this._cardSelector=c,this._handleImageClick=r,this._likes=n.likes,this._handleLikeClick=o,this._cardId=n._id,this._deleteConfirmationForm=i,this._currentUserId=a,this._ownerId=n.owner._id}var n,r;return n=t,(r=[{key:"getCardId",value:function(){return this._cardId}},{key:"_getTemplate",value:function(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}},{key:"handleDeleteCard",value:function(){this._element.remove(),this._element=null}},{key:"isLiked",value:function(){return this._loveIcon.classList.contains("card__button_active")}},{key:"handleLikeData",value:function(e){this._loveIcon.classList.toggle("card__button_active"),this._cardLikesCounter.textContent=e.likes.length}},{key:"generateCard",value:function(){var e=this;return this._element=this._getTemplate(),this._element.querySelector(".card__title").textContent=this._name,this._imageElement=this._element.querySelector(".card__img"),this._imageElement.src=this._link,this._imageElement.alt=this._name,this._imageElement.addEventListener("click",this._handleImageClick),this._cardLikesCounter=this._element.querySelector(".card__likes-counter"),this._cardLikesCounter.textContent=this._likes.length,this._loveIcon=this._element.querySelector(".card__button"),this._trashIcon=this._element.querySelector(".card__delete"),this._ownerId!==this._currentUserId&&(this._trashIcon.remove(),this._trashIcon=null),this._likes.some((function(t){return t._id===e._currentUserId}))&&this._loveIcon.classList.add("card__button_active"),this._setEventListeners(),this._element}},{key:"_setEventListeners",value:function(){var e=this;this._loveIcon.addEventListener("click",(function(){e._handleLikeClick(e)})),this._trashIcon&&this._trashIcon.addEventListener("click",(function(){e._deleteConfirmationForm(e)}))}}])&&e(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}();function n(e){return function(e){if(Array.isArray(e))return r(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._inputSelector=t.inputSelector,this._submitButtonSelector=t.submitButtonSelector,this._inactiveButtonClass=t.inactiveButtonClass,this._inputErrorClass=t.inputErrorClass,this._errorClass=t.errorClass,this._formElement=n}var t,r;return t=e,(r=[{key:"_showInputError",value:function(e,t){var n=this._formElement.querySelector(".".concat(e.id,"-input-error"));e.classList.add(this._inputErrorClass),n.textContent=t,n.classList.add(this._errorClass)}},{key:"_hideInputError",value:function(e){var t=this._formElement.querySelector(".".concat(e.id,"-input-error"));e.classList.remove(this._inputErrorClass),t.classList.remove(this._errorClass),t.textContent=""}},{key:"_hasInvalidInput",value:function(){return n(this._inputList).some((function(e){return!e.validity.valid}))}},{key:"_toggleInputError",value:function(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}},{key:"_toggleButtonState",value:function(){this._hasInvalidInput()?(this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.disabled=!0):(this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.disabled=!1)}},{key:"_setEventListeners",value:function(){var e=this;this._inputList=n(this._formElement.querySelectorAll(this._inputSelector)),this._buttonElement=this._formElement.querySelector(this._submitButtonSelector),this._inputList.forEach((function(t){t.addEventListener("input",(function(){e._toggleInputError(t),e._toggleButtonState()}))}))}},{key:"enableValidation",value:function(){this._formElement.addEventListener("submit",(function(e){e.preventDefault()})),this._setEventListeners()}},{key:"resetValidation",value:function(){var e=this;this._inputList.forEach((function(t){e._hideInputError(t)})),this._toggleButtonState()}}])&&o(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var c=function(){function e(t){var n=t.items,r=t.renderer,o=t.containerSelector;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._items=n,this._renderer=r,this._container=document.querySelector(o)}var t,n;return t=e,(n=[{key:"renderItems",value:function(){var e=this;this._items.forEach((function(t){e._renderer(t)}))}},{key:"addItem",value:function(e){this._container.prepend(e)}}])&&a(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._popupElement=document.querySelector(t),this._handleEscClose=this._handleEscClose.bind(this),this._handleMouseDown=this._handleMouseDown.bind(this)}var t,n;return t=e,(n=[{key:"open",value:function(){this._popupElement.classList.add("forms_is-open"),document.addEventListener("keydown",this._handleEscClose),document.addEventListener("mousedown",this._handleMouseDown)}},{key:"close",value:function(){this._popupElement.classList.remove("forms_is-open"),document.removeEventListener("keydown",this._handleEscClose),document.removeEventListener("mousedown",this._handleMouseDown)}},{key:"_handleMouseDown",value:function(e){(e.target.classList.contains("forms")||e.target.classList.contains("forms__button-close"))&&this.close()}},{key:"_handleEscClose",value:function(e){"Escape"===e.key&&this.close()}}])&&u(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(){return h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=p(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},h.apply(this,arguments)}function p(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=m(e)););return e}function d(e,t){return d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},d(e,t)}function y(e,t){if(t&&("object"===l(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function m(e){return m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},m(e)}var _=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=m(r);if(o){var n=m(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return y(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e))._popupImage=document.querySelector(".forms__image"),t._popupImageTitle=document.querySelector(".forms__image-title"),t}return t=a,(n=[{key:"open",value:function(e){this._popupImage.src=e.link,this._popupImage.alt="Image ".concat(e.name),this._popupImageTitle.textContent=e.name,h(m(a.prototype),"open",this).call(this)}}])&&f(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(s);function b(e){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b(e)}function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function g(){return g="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=S(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},g.apply(this,arguments)}function S(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=E(e)););return e}function k(e,t){return k=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},k(e,t)}function w(e,t){if(t&&("object"===b(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function E(e){return E=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},E(e)}var I=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&k(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=E(r);if(o){var n=E(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return w(this,e)});function a(e){var t,n=e.popupSelector,r=e.handleFormSubmit;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,n))._form=t._popupElement.querySelector(".form"),t._handleFormSubmit=r,t._inputList=t._form.querySelectorAll(".form__input"),t._submitButton=t._form.querySelector(".form__button"),t._buttonText=t._submitButton.textContent,t}return t=a,(n=[{key:"_getInputValues",value:function(){var e=this;return this._formValues={},this._inputList.forEach((function(t){e._formValues[t.name]=t.value})),this._formValues}},{key:"setEventListeners",value:function(){var e=this;this._form.addEventListener("submit",(function(t){t.preventDefault(),e._handleFormSubmit(e._getInputValues()),e.close()}))}},{key:"close",value:function(){this._form.reset(),g(E(a.prototype),"close",this).call(this)}},{key:"renderLoading",value:function(e){this._submitButton.textContent=e?"Saving ...":this._buttonText}}])&&v(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(s);function C(e){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},C(e)}function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function j(){return j="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=L(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},j.apply(this,arguments)}function L(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=T(e)););return e}function P(e,t){return P=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},P(e,t)}function q(e,t){if(t&&("object"===C(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function T(e){return T=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},T(e)}var R=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&P(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=T(r);if(o){var n=T(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return q(this,e)});function a(e){var t,n=e.popupSelector;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,n))._yesButton=t._popupElement.querySelector(".form__button"),t}return t=a,(n=[{key:"open",value:function(){this._yesButton.addEventListener("click",this._handleYesSubmit),j(T(a.prototype),"open",this).call(this)}},{key:"close",value:function(){this._yesButton.removeEventListener("click",this._handleYesSubmit),j(T(a.prototype),"close",this).call(this)}},{key:"setSubmit",value:function(e){this._handleYesSubmit=e}}])&&O(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(s);function U(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var B=function(){function e(t){var n=t.userNameSelector,r=t.userOccupationSelector,o=t.userPictureSelector;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._profileName=document.querySelector(n),this._profileJob=document.querySelector(r),this._userPicture=document.querySelector(o)}var t,n;return t=e,(n=[{key:"getUserInfo",value:function(){return{userInputName:this._profileName.textContent,userInputJob:this._profileJob.textContent}}},{key:"setUserInfo",value:function(e){var t=e.userInputName,n=e.userInputJob,r=e.userAvatar;this._profileName.textContent=t,this._profileJob.textContent=n,this._userPicture.src=r}}])&&U(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function x(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var A,D,N=function(){function e(t){var n=t.baseUrl,r=t.headers;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._baseUrl=n,this._headers=r}var t,n;return t=e,(n=[{key:"promiseAll",value:function(){return Promise.all([this.getUserData(),this.getInitialCards()])}},{key:"getInitialCards",value:function(){return fetch("".concat(this._baseUrl,"/cards"),{headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))})).catch((function(e){console.log(e)}))}},{key:"getUserData",value:function(){return fetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))})).catch((function(e){console.log(e)}))}},{key:"editProfileInfo",value:function(e){var t=e.username,n=e.about;return fetch("".concat(this._baseUrl,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:n})}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))})).catch((function(e){console.log(e)}))}},{key:"editProfilePicture",value:function(e){var t=e.avatar;return fetch("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:t})}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))})).catch((function(e){console.log(e)}))}},{key:"addNewCard",value:function(e){var t=e.name,n=e.link;return fetch("".concat(this._baseUrl,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:n})}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))})).catch((function(e){console.log(e)}))}},{key:"deleteCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e),{method:"DELETE",headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))})).catch((function(e){console.log(e)}))}},{key:"addLike",value:function(e){return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))})).catch((function(e){console.log(e)}))}},{key:"removeLike",value:function(e){return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))})).catch((function(e){console.log(e)}))}}])&&x(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),V={formSelector:".forms",inputSelector:".form__input",submitButtonSelector:".form__button",inactiveButtonClass:"form__button_disabled",inputErrorClass:"form__input_type_error",errorClass:"form__error-text_active"},J=(document.querySelector(".cards__container"),document.querySelector("#edit-profile")),F=document.querySelector("#img-add"),M=document.querySelector("#add-form"),Y=(document.querySelector("#edit-form"),document.querySelector("#update-avatar-popup")),H=document.querySelector("#avatar-form"),$=document.querySelector(".profile__button-name-edit"),z=document.querySelector(".profile__button-add"),G=document.querySelector(".profile__img-icon"),K=(J.querySelector(".forms__button-close"),F.querySelector(".forms__button-close"),document.querySelector(".profile__name"),document.querySelector(".profile__about"),J.querySelector("#username")),Q=J.querySelector("#about");function W(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}F.querySelector("#title"),F.querySelector("#image-link");var X=new N({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"66d060c3-a92b-49d0-add5-d7e29bf411c9","Content-Type":"application/json"}}),Z=new i(V,J),ee=new i(V,F),te=new i(V,Y);Z.enableValidation(),ee.enableValidation(),te.enableValidation(),X.promiseAll().then((function(e){var t,n,r=(n=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,c=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){c=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(c)throw o}}return i}}(t,n)||function(e,t){if(e){if("string"==typeof e)return W(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?W(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=r[0],i=r[1];ie.setUserInfo({userInputName:o.name,userInputJob:o.about,userAvatar:o.avatar}),D=o._id,(A=new c({items:i,renderer:ue,containerSelector:".cards__container"})).renderItems()})).catch((function(e){return console.error("Error while executing: ".concat(e))}));var ne=new I({popupSelector:"#img-add",handleFormSubmit:function(e){X.addNewCard(e).then((function(e){return ue(e)}))}});ne.setEventListeners();var re=new I({popupSelector:"#edit-profile",handleFormSubmit:function(e){re.renderLoading(!0),X.editProfileInfo(e).then((function(e){console.log(e),ie.setUserInfo({userInputName:e.name,userInputJob:e.about,userAvatar:e.avatar})})).catch((function(e){console.log(e)})).finally((function(){re.renderLoading(!1)}))}});re.setEventListeners();var oe=new I({popupSelector:"#update-avatar-popup",handleFormSubmit:function(e){oe.renderLoading(!0),X.editProfilePicture(e).then((function(e){ie.setUserInfo({userInputName:e.name,userInputJob:e.about,userAvatar:e.avatar})})).catch((function(e){console.log(e)})).finally((function(){oe.renderLoading(!1)}))}});oe.setEventListeners();var ie=new B({userNameSelector:".profile__name",userOccupationSelector:".profile__about",userPictureSelector:".profile__img"}),ae=new _("#image-show"),ce=new R({popupSelector:"#confirm-popup"});function ue(e){var n=new t({data:e,handleImageClick:function(){ae.open(e)},handleTrashClick:function(){ce.setSubmit((function(){console.log(n.getCardId()),X.deleteCard(n.getCardId()).then((function(e){ce.close(),n.handleDeleteCard()})).catch((function(e){console.log(e)}))})),ce.open()},handleLikeClick:function(e){e.isLiked()?X.removeLike(e.getCardId()).then((function(t){return e.handleLikeData(t)})).catch((function(e){console.log(e)})):X.addLike(e.getCardId()).then((function(t){return e.handleLikeData(t)})).catch((function(e){console.log(e)}))},currentUserId:D,cardSelector:"#card"}),r=n.generateCard();A.addItem(r)}$.addEventListener("click",(function(){var e,t,n;t=(e=ie.getUserInfo()).userInputName,n=e.userInputJob,K.value=t,Q.value=n,Z.resetValidation(),re.open()})),z.addEventListener("click",(function(){M.reset(),ee.resetValidation(),ne.open()})),G.addEventListener("click",(function(){H.reset(),te.resetValidation(),oe.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoibU1BQXFCQSxFQUFBQSxXQUNuQixjQU9HLElBTkRDLEVBTUMsRUFOREEsS0FDQUMsRUFLQyxFQUxEQSxpQkFDQUMsRUFJQyxFQUpEQSxnQkFDQUMsRUFHQyxFQUhEQSxpQkFDQUMsRUFFQyxFQUZEQSxjQUNBQyxFQUNDLEVBRERBLGMsNEZBQ0MsU0FDREMsS0FBS0MsTUFBUVAsRUFBS1EsS0FDbEJGLEtBQUtHLE1BQVFULEVBQUtVLEtBQ2xCSixLQUFLSyxjQUFnQk4sRUFDckJDLEtBQUtNLGtCQUFvQlgsRUFDekJLLEtBQUtPLE9BQVNiLEVBQUtjLE1BQ25CUixLQUFLUyxpQkFBbUJiLEVBQ3hCSSxLQUFLVSxRQUFVaEIsRUFBS2lCLElBQ3BCWCxLQUFLWSx3QkFBMEJmLEVBQy9CRyxLQUFLYSxlQUFpQmYsRUFDdEJFLEtBQUtjLFNBQVdwQixFQUFLcUIsTUFBTUosSSw4Q0FFN0IsV0FDRSxPQUFPWCxLQUFLVSxVLDBCQUVkLFdBS0UsT0FKb0JNLFNBQVNDLGNBQWNqQixLQUFLSyxlQUN2QmEsUUFBUUQsY0FBYyxTQUN0QkUsV0FBVSxLLDhCQUtyQyxXQUNFbkIsS0FBS29CLFNBQVNDLFNBQ2RyQixLQUFLb0IsU0FBVyxPLHFCQUVsQixXQUNFLE9BQU9wQixLQUFLc0IsVUFBVUMsVUFBVUMsU0FBUyx5Qiw0QkFFM0MsU0FBZUMsR0FDYnpCLEtBQUtzQixVQUFVQyxVQUFVRyxPQUFPLHVCQUNoQzFCLEtBQUsyQixrQkFBa0JDLFlBQWNILEVBQU9qQixNQUFNcUIsUywwQkFFcEQsV0FBZSxXQW9CYixPQW5CQTdCLEtBQUtvQixTQUFXcEIsS0FBSzhCLGVBQ3JCOUIsS0FBS29CLFNBQVNILGNBQWMsZ0JBQWdCVyxZQUFjNUIsS0FBS0MsTUFDL0RELEtBQUsrQixjQUFnQi9CLEtBQUtvQixTQUFTSCxjQUFjLGNBQ2pEakIsS0FBSytCLGNBQWNDLElBQU1oQyxLQUFLRyxNQUM5QkgsS0FBSytCLGNBQWNFLElBQU1qQyxLQUFLQyxNQUM5QkQsS0FBSytCLGNBQWNHLGlCQUFpQixRQUFTbEMsS0FBS00sbUJBQ2xETixLQUFLMkIsa0JBQ0QzQixLQUFLb0IsU0FBU0gsY0FBYyx3QkFDaENqQixLQUFLMkIsa0JBQWtCQyxZQUFjNUIsS0FBS08sT0FBT3NCLE9BQ2pEN0IsS0FBS3NCLFVBQVl0QixLQUFLb0IsU0FBU0gsY0FBYyxpQkFDN0NqQixLQUFLbUMsV0FBYW5DLEtBQUtvQixTQUFTSCxjQUFjLGlCQUMxQ2pCLEtBQUtjLFdBQWFkLEtBQUthLGlCQUN6QmIsS0FBS21DLFdBQVdkLFNBQ2hCckIsS0FBS21DLFdBQWEsTUFFaEJuQyxLQUFLTyxPQUFPNkIsTUFBSyxTQUFBQyxHQUFJLE9BQUlBLEVBQUsxQixNQUFRLEVBQUtFLG1CQUM3Q2IsS0FBS3NCLFVBQVVDLFVBQVVlLElBQUksdUJBRS9CdEMsS0FBS3VDLHFCQUNFdkMsS0FBS29CLFcsZ0NBR2QsV0FBcUIsV0FFbkJwQixLQUFLc0IsVUFBVVksaUJBQWlCLFNBQVMsV0FDdkMsRUFBS3pCLGlCQUFpQixNQUdwQlQsS0FBS21DLFlBQ1BuQyxLQUFLbUMsV0FBV0QsaUJBQWlCLFNBQVMsV0FDeEMsRUFBS3RCLHdCQUF3QixXLHNFQXpFaEJuQixHLDA1QkNBQStDLEVBQUFBLFdBQ25CLFdBQVlDLEVBQVVDLEksNEZBQWEsU0FDakMxQyxLQUFLMkMsZUFBaUJGLEVBQVNHLGNBQy9CNUMsS0FBSzZDLHNCQUF3QkosRUFBU0sscUJBQ3RDOUMsS0FBSytDLHFCQUF1Qk4sRUFBU08sb0JBQ3JDaEQsS0FBS2lELGlCQUFtQlIsRUFBU1MsZ0JBQ2pDbEQsS0FBS21ELFlBQWNWLEVBQVNXLFdBQzVCcEQsS0FBS3FELGFBQWVYLEUsb0RBRXRCLFNBQWdCWSxFQUFTQyxHQUN2QixJQUFNQyxFQUNGeEQsS0FBS3FELGFBQWFwQyxjQUFsQixXQUFvQ3FDLEVBQVFHLEdBQTVDLGlCQUNMSCxFQUFRL0IsVUFBVWUsSUFBSXRDLEtBQUtpRCxrQkFDMUJPLEVBQWE1QixZQUFjMkIsRUFDM0JDLEVBQWFqQyxVQUFVZSxJQUFJdEMsS0FBS21ELGUsNkJBRWxDLFNBQWdCRyxHQUNkLElBQU1FLEVBQ0Z4RCxLQUFLcUQsYUFBYXBDLGNBQWxCLFdBQW9DcUMsRUFBUUcsR0FBNUMsaUJBQ0pILEVBQVEvQixVQUFVRixPQUFPckIsS0FBS2lELGtCQUM5Qk8sRUFBYWpDLFVBQVVGLE9BQU9yQixLQUFLbUQsYUFDbkNLLEVBQWE1QixZQUFjLEssOEJBRzdCLFdBRUUsT0FBTyxFQUFJNUIsS0FBSzBELFlBQVl0QixNQUFLLFNBQUNrQixHQUFELE9BQWNBLEVBQVFLLFNBQVNDLFcsK0JBSWxFLFNBQWtCTixHQUNYQSxFQUFRSyxTQUFTQyxNQUtwQjVELEtBQUs2RCxnQkFBZ0JQLEdBSHJCdEQsS0FBSzhELGdCQUFnQlIsRUFBU0EsRUFBUVMscUIsZ0NBTzFDLFdBRU0vRCxLQUFLZ0Usb0JBQ1BoRSxLQUFLaUUsZUFBZTFDLFVBQVVlLElBQUl0QyxLQUFLK0Msc0JBQ3ZDL0MsS0FBS2lFLGVBQWVDLFVBQVcsSUFFL0JsRSxLQUFLaUUsZUFBZTFDLFVBQVVGLE9BQU9yQixLQUFLK0Msc0JBQzFDL0MsS0FBS2lFLGVBQWVDLFVBQVcsSyxnQ0FJbkMsV0FBcUIsV0FDZmxFLEtBQUswRCxXQUFMLEVBQ0kxRCxLQUFLcUQsYUFBYWMsaUJBQWlCbkUsS0FBSzJDLGlCQUNoRDNDLEtBQUtpRSxlQUNEakUsS0FBS3FELGFBQWFwQyxjQUFjakIsS0FBSzZDLHVCQUN6QzdDLEtBQUswRCxXQUFXVSxTQUFRLFNBQUNDLEdBQ3ZCQSxFQUFhbkMsaUJBQWlCLFNBQVMsV0FDckMsRUFBS29DLGtCQUFrQkQsR0FDdkIsRUFBS0UsNkIsOEJBS1gsV0FDRXZFLEtBQUtxRCxhQUFhbkIsaUJBQWlCLFVBQVUsU0FBQ3NDLEdBQzVDQSxFQUFJQyxvQkFFTnpFLEtBQUt1Qyx1Qiw2QkFFUCxXQUFrQixXQUNkdkMsS0FBSzBELFdBQVdVLFNBQVEsU0FBQ2QsR0FDekIsRUFBS08sZ0JBQWdCUCxNQUd2QnRELEtBQUt1RSwwQixzRUEzRVkvQixHLDBLQ0FBa0MsRUFBQUEsV0FDbkIsY0FBb0QsSUFBdENDLEVBQXNDLEVBQXRDQSxNQUFPQyxFQUErQixFQUEvQkEsU0FBV0MsRUFBb0IsRUFBcEJBLG1CLDRGQUFvQixTQUNsRDdFLEtBQUs4RSxPQUFTSCxFQUNkM0UsS0FBSytFLFVBQVlILEVBQ2pCNUUsS0FBS2dGLFdBQWFoRSxTQUFTQyxjQUFjNEQsRyxnREFFM0MsV0FBYyxXQUNaN0UsS0FBSzhFLE9BQU9WLFNBQVEsU0FBQS9CLEdBQ2xCLEVBQUswQyxVQUFVMUMsUSxxQkFJbkIsU0FBUWlCLEdBQ050RCxLQUFLZ0YsV0FBV0MsUUFBUTNCLFEsc0VBYlBvQixHLDBLQ0FBUSxFQUFBQSxXQUNuQixXQUFZQyxJLDRGQUFlLFNBQ3pCbkYsS0FBS29GLGNBQWdCcEUsU0FBU0MsY0FBY2tFLEdBQzVDbkYsS0FBS3FGLGdCQUFrQnJGLEtBQUtxRixnQkFBZ0JDLEtBQUt0RixNQUNqREEsS0FBS3VGLGlCQUFtQnZGLEtBQUt1RixpQkFBaUJELEtBQUt0RixNLHlDQUdyRCxXQUNFQSxLQUFLb0YsY0FBYzdELFVBQVVlLElBQUksaUJBQ2hDdEIsU0FBU2tCLGlCQUFpQixVQUFXbEMsS0FBS3FGLGlCQUMxQ3JFLFNBQVNrQixpQkFBaUIsWUFBYWxDLEtBQUt1RixvQixtQkFFL0MsV0FDRXZGLEtBQUtvRixjQUFjN0QsVUFBVUYsT0FBTyxpQkFDcENMLFNBQVN3RSxvQkFBb0IsVUFBV3hGLEtBQUtxRixpQkFDN0NyRSxTQUFTd0Usb0JBQW9CLFlBQWF4RixLQUFLdUYsb0IsOEJBR2pELFNBQWlCZixJQUViQSxFQUFJaUIsT0FBT2xFLFVBQVVDLFNBQVMsVUFDOUJnRCxFQUFJaUIsT0FBT2xFLFVBQVVDLFNBQVMseUJBRTlCeEIsS0FBSzBGLFUsNkJBR1QsU0FBZ0JsQixHQUNFLFdBQVpBLEVBQUltQixLQUNOM0YsS0FBSzBGLGEsc0VBNUJVUixHLCt0Q0NDQVUsRUFBQUEsU0FBQUEsSSw2ckJBQ25CLFdBQVlULEdBQWUsYSw0RkFBQSxVQUN6QixjQUFNQSxJQUVEVSxZQUFjN0UsU0FBU0MsY0FBYyxpQkFDMUMsRUFBSzZFLGlCQUFtQjlFLFNBQVNDLGNBQWMsdUJBSnRCLEUsaUNBTTNCLFNBQUt2QixHQUNITSxLQUFLNkYsWUFBWTdELElBQU10QyxFQUFLVSxLQUM1QkosS0FBSzZGLFlBQVk1RCxJQUFqQixnQkFBZ0N2QyxFQUFLUSxNQUNyQ0YsS0FBSzhGLGlCQUFpQmxFLFlBQWNsQyxFQUFLUSxLQUN6Qyw4QyxzRUFYaUIwRixDQUF1QlYsRywrdENDRXZCYSxFQUFBQSxTQUFBQSxJLDZyQkFDbkIsY0FBK0MsTUFBbENaLEVBQWtDLEVBQWxDQSxjQUFlYSxFQUFtQixFQUFuQkEsaUJBQW1CLE8sNEZBQUEsVUFDN0MsY0FBTWIsSUFDRGMsTUFBUSxFQUFLYixjQUFjbkUsY0FBYyxTQUM5QyxFQUFLaUYsa0JBQW9CRixFQUN6QixFQUFLdEMsV0FBYSxFQUFLdUMsTUFBTTlCLGlCQUFpQixnQkFDOUMsRUFBS2dDLGNBQWdCLEVBQUtGLE1BQU1oRixjQUFjLGlCQUM5QyxFQUFLbUYsWUFBYyxFQUFLRCxjQUFjdkUsWUFOTyxFLDRDQVEvQyxXQUFrQixXQVNoQixPQVBBNUIsS0FBS3FHLFlBQWMsR0FHbkJyRyxLQUFLMEQsV0FBV1UsU0FBUSxTQUFDa0MsR0FDdkIsRUFBS0QsWUFBWUMsRUFBTXBHLE1BQVFvRyxFQUFNQyxTQUdoQ3ZHLEtBQUtxRyxjLCtCQUdkLFdBQW9CLFdBQ2xCckcsS0FBS2lHLE1BQU0vRCxpQkFBaUIsVUFBVSxTQUFDc0MsR0FDckNBLEVBQUlDLGlCQUNKLEVBQUt5QixrQkFBa0IsRUFBS00sbUJBQzVCLEVBQUtkLGEsbUJBSVQsV0FDRTFGLEtBQUtpRyxNQUFNUSxRQUNYLDRDLDJCQUVGLFNBQWNDLEdBRVYxRyxLQUFLbUcsY0FBY3ZFLFlBRGpCOEUsRUFDK0IsYUFFQTFHLEtBQUtvRyxpQixzRUFyQ3ZCTCxDQUFzQmIsRywrdENDRnRCeUIsRUFBQUEsU0FBQUEsSSw2ckJBQ25CLGNBQTRCLE1BQWZ4QixFQUFlLEVBQWZBLGNBQWUsTyw0RkFBQSxVQUMxQixjQUFNQSxJQUVEeUIsV0FBYSxFQUFLeEIsY0FBY25FLGNBQWMsaUJBSHpCLEUsaUNBSzVCLFdBQ0VqQixLQUFLNEcsV0FBVzFFLGlCQUFpQixRQUFTbEMsS0FBSzZHLGtCQUMvQywyQyxtQkFHRixXQUVFN0csS0FBSzRHLFdBQVdwQixvQkFBb0IsUUFBUXhGLEtBQUs2RyxrQkFDakQsNEMsdUJBR0YsU0FBVUMsR0FDUjlHLEtBQUs2RyxpQkFBbUJDLE8sc0VBbEJQSCxDQUE4QnpCLEcsMEtDRDlCNkIsRUFBQUEsV0FDbkIsY0FBNkUsSUFBaEVDLEVBQWdFLEVBQWhFQSxpQkFBa0JDLEVBQThDLEVBQTlDQSx1QkFBd0JDLEVBQXNCLEVBQXRCQSxxQiw0RkFBc0IsU0FDM0VsSCxLQUFLbUgsYUFBZW5HLFNBQVNDLGNBQWMrRixHQUMzQ2hILEtBQUtvSCxZQUFjcEcsU0FBU0MsY0FBY2dHLEdBQzFDakgsS0FBS3FILGFBQWVyRyxTQUFTQyxjQUFjaUcsRyxnREFHN0MsV0FDRSxNQUFPLENBQ0xJLGNBQWV0SCxLQUFLbUgsYUFBYXZGLFlBQ2pDMkYsYUFBY3ZILEtBQUtvSCxZQUFZeEYsZSx5QkFJbkMsWUFBdUQsSUFBMUMwRixFQUEwQyxFQUExQ0EsY0FBZUMsRUFBMkIsRUFBM0JBLGFBQWNDLEVBQWEsRUFBYkEsV0FDeEN4SCxLQUFLbUgsYUFBYXZGLFlBQWMwRixFQUNoQ3RILEtBQUtvSCxZQUFZeEYsWUFBYzJGLEVBQy9CdkgsS0FBS3FILGFBQWFyRixJQUFNd0YsTyxzRUFqQlBULEcsMEtDd0JqQlUsRUFDQTNILEVDekJpQjRILEVBQUFBLFdBQ25CLGNBQWtDLElBQXBCQyxFQUFvQixFQUFwQkEsUUFBU0MsRUFBVyxFQUFYQSxTLDRGQUFXLFNBQ2hDNUgsS0FBSzZILFNBQVdGLEVBQ2hCM0gsS0FBSzhILFNBQVdGLEUsK0NBRWxCLFdBQ0EsT0FBT0csUUFBUUMsSUFBSSxDQUFDaEksS0FBS2lJLGNBQWVqSSxLQUFLa0ksc0IsNkJBRzdDLFdBQ0UsT0FBT0MsTUFBTSxHQUFELE9BQUluSSxLQUFLNkgsU0FBVCxVQUEyQixDQUFFRCxRQUFTNUgsS0FBSzhILFdBQ3BETSxNQUFLLFNBQUNDLEdBQ0wsT0FBSUEsRUFBSUMsR0FDQ0QsRUFBSUUsT0FHTlIsUUFBUVMsT0FBUixpQkFBeUJILEVBQUlJLFlBRXJDQyxPQUFNLFNBQUNDLEdBQ05DLFFBQVFDLElBQUlGLFEseUJBR2xCLFdBQ0UsT0FBT1IsTUFBTSxHQUFELE9BQUluSSxLQUFLNkgsU0FBVCxhQUNWLENBQUVELFFBQVM1SCxLQUFLOEgsV0FFZk0sTUFBSyxTQUFDQyxHQUNMLE9BQUlBLEVBQUlDLEdBQ0NELEVBQUlFLE9BR05SLFFBQVFTLE9BQVIsaUJBQXlCSCxFQUFJSSxZQUdyQ0MsT0FBTSxTQUFDQyxHQUNOQyxRQUFRQyxJQUFJRixRLDZCQUdsQixZQUFtQyxJQUFsQkcsRUFBa0IsRUFBbEJBLFNBQVVDLEVBQVEsRUFBUkEsTUFFekIsT0FBT1osTUFBTSxHQUFELE9BQUluSSxLQUFLNkgsU0FBVCxhQUE4QixDQUN4Q21CLE9BQVEsUUFDUnBCLFFBQVM1SCxLQUFLOEgsU0FDZG1CLEtBQU1DLEtBQUtDLFVBQVUsQ0FDckJqSixLQUFNNEksRUFDTkMsTUFBT0EsTUFHVlgsTUFBSyxTQUFDQyxHQUNMLE9BQUlBLEVBQUlDLEdBQ0NELEVBQUlFLE9BR05SLFFBQVFTLE9BQVIsaUJBQXlCSCxFQUFJSSxZQUVyQ0MsT0FBTSxTQUFDQyxHQUNOQyxRQUFRQyxJQUFJRixRLGdDQUdkLFlBQTZCLElBQVRTLEVBQVMsRUFBVEEsT0FFcEIsT0FBT2pCLE1BQU0sR0FBRCxPQUFJbkksS0FBSzZILFNBQVQsb0JBQXFDLENBQy9DbUIsT0FBUSxRQUNScEIsUUFBUzVILEtBQUs4SCxTQUNkbUIsS0FBTUMsS0FBS0MsVUFBVSxDQUNyQkMsT0FBQUEsTUFHSGhCLE1BQUssU0FBQ0MsR0FDTCxPQUFJQSxFQUFJQyxHQUNDRCxFQUFJRSxPQUdOUixRQUFRUyxPQUFSLGlCQUF5QkgsRUFBSUksWUFFckNDLE9BQU0sU0FBQ0MsR0FDTkMsUUFBUUMsSUFBSUYsUSx3QkFHWixZQUF3QixJQUFaekksRUFBWSxFQUFaQSxLQUFLRSxFQUFPLEVBQVBBLEtBRWYsT0FBTytILE1BQU0sR0FBRCxPQUFJbkksS0FBSzZILFNBQVQsVUFBMkIsQ0FDckNtQixPQUFRLE9BQ1JwQixRQUFTNUgsS0FBSzhILFNBQ2RtQixLQUFNQyxLQUFLQyxVQUFVLENBQ3JCakosS0FBQUEsRUFDQUUsS0FBQUEsTUFHSGdJLE1BQUssU0FBQ0MsR0FDTCxPQUFJQSxFQUFJQyxHQUNDRCxFQUFJRSxPQUdOUixRQUFRUyxPQUFSLGlCQUF5QkgsRUFBSUksWUFFckNDLE9BQU0sU0FBQ0MsR0FDTkMsUUFBUUMsSUFBSUYsUSx3QkFHZCxTQUFXVSxHQUVULE9BQU9sQixNQUFNLEdBQUQsT0FBSW5JLEtBQUs2SCxTQUFULGtCQUEyQndCLEdBQ3ZDLENBQUdMLE9BQU8sU0FDUHBCLFFBQVM1SCxLQUFLOEgsV0FDZE0sTUFBSyxTQUFDQyxHQUNMLE9BQUlBLEVBQUlDLEdBQ0NELEVBQUlFLE9BR05SLFFBQVFTLE9BQVIsaUJBQXlCSCxFQUFJSSxZQUVyQ0MsT0FBTSxTQUFDQyxHQUNOQyxRQUFRQyxJQUFJRixRLHFCQUlsQixTQUFRVSxHQUVOLE9BQU9sQixNQUFNLEdBQUQsT0FBSW5JLEtBQUs2SCxTQUFULHdCQUFpQ3dCLEdBQ3pDLENBQUdMLE9BQU8sTUFDWHBCLFFBQVM1SCxLQUFLOEgsV0FDZE0sTUFBSyxTQUFDQyxHQUVMLE9BQUlBLEVBQUlDLEdBQ0NELEVBQUlFLE9BR05SLFFBQVFTLE9BQVIsaUJBQXlCSCxFQUFJSSxZQUVyQ0MsT0FBTSxTQUFDQyxHQUNOQyxRQUFRQyxJQUFJRixRLHdCQUdsQixTQUFXVSxHQUVULE9BQU9sQixNQUFNLEdBQUQsT0FBSW5JLEtBQUs2SCxTQUFULHdCQUFpQ3dCLEdBQzdDLENBQUdMLE9BQU8sU0FDUHBCLFFBQVM1SCxLQUFLOEgsV0FDZE0sTUFBSyxTQUFDQyxHQUNMLE9BQUlBLEVBQUlDLEdBQ0NELEVBQUlFLE9BR05SLFFBQVFTLE9BQVIsaUJBQXlCSCxFQUFJSSxZQUVyQ0MsT0FBTSxTQUFDQyxHQUNOQyxRQUFRQyxJQUFJRixXLHNFQW5KQ2pCLEdDQWY0QixFQUF5QixDQUM3QkMsYUFBYyxTQUNkM0csY0FBZSxlQUNmRSxxQkFBc0IsZ0JBQ3RCRSxvQkFBcUIsd0JBQ3JCRSxnQkFBaUIseUJBQ2pCRSxXQUFZLDJCQUtSb0csR0FEaUJ4SSxTQUFTQyxjQUFjLHFCQUN0QkQsU0FBU0MsY0FBYyxrQkFDekN3SSxFQUFlekksU0FBU0MsY0FBYyxZQUN0Q3lJLEVBQVkxSSxTQUFTQyxjQUFjLGFBRW5DMEksR0FEYzNJLFNBQVNDLGNBQWMsY0FDakJELFNBQVNDLGNBQWMseUJBQzNDMkksRUFBYTVJLFNBQVNDLGNBQWMsZ0JBR3BDNEksRUFDRjdJLFNBQVNDLGNBQWMsOEJBQ3JCNkksRUFBcUI5SSxTQUFTQyxjQUFjLHdCQUM1QzhJLEVBQTJCL0ksU0FBU0MsY0FBYyxzQkFZbEQrSSxHQVZGUixFQUFnQnZJLGNBQWMsd0JBRzlCd0ksRUFBYXhJLGNBQWMsd0JBR1hELFNBQVNDLGNBQWMsa0JBQ3hCRCxTQUFTQyxjQUFjLG1CQUdwQnVJLEVBQWdCdkksY0FBYyxjQUM5Q2dKLEVBQWVULEVBQWdCdkksY0FBYyxVLDBHQUN2QndJLEVBQWF4SSxjQUFjLFVBQ2pDd0ksRUFBYXhJLGNBQWMsZUZYakQsSUFBTWlKLEVBQU0sSUFBSXhDLEVBQUksQ0FDbEJDLFFBQVMsOENBQ1RDLFFBQVMsQ0FDUHVDLGNBQWUsdUNBQ2YsZUFBZ0Isc0JBSWRDLEVBQTJCLElBQUk1SCxFQUNuQzhHLEVBQ0FFLEdBRUlhLEdBQXdCLElBQUk3SCxFQUNoQzhHLEVBQ0FHLEdBRUlhLEdBQWtDLElBQUk5SCxFQUMxQzhHLEVBQ0FLLEdBRUZTLEVBQXlCRyxtQkFDekJGLEdBQXNCRSxtQkFDdEJELEdBQWdDQyxtQkFFaENMLEVBQUlNLGFBQ0hwQyxNQUFLLFlBQXFCLEksSUFBQSxHLEVBQUEsRSw0Q0FBQSxJLGd4QkFBbkJxQyxFQUFtQixLQUFkQyxFQUFjLEtBQ3pCQyxHQUFZQyxZQUFZLENBQ3RCdEQsY0FBZW1ELEVBQUt2SyxLQUNwQnFILGFBQWNrRCxFQUFLMUIsTUFDbkJ2QixXQUFZaUQsRUFBS3JCLFNBRW5CdEosRUFBZ0IySyxFQUFLOUosS0FDckI4RyxFQUFXLElBQUkvQyxFQUNiLENBQ0VDLE1BQU8rRixFQUNQOUYsU0FBVWlHLEdBQ1ZoRyxrQkFBbUIsdUJBR2RpRyxpQkFHVnBDLE9BQU0sU0FBQUMsR0FBRyxPQUFJQyxRQUFRbUMsTUFBUixpQ0FBd0NwQyxPQUd0RCxJQUFNcUMsR0FBa0IsSUFBSWpGLEVBQWMsQ0FDeENaLGNBQWUsV0FDZmEsaUJBQWtCLFNBQUN0RyxHQUNoQndLLEVBQUllLFdBQVd2TCxHQUNmMEksTUFBSyxTQUFBMUksR0FBSSxPQUNWbUwsR0FBV25MLFNBR2ZzTCxHQUFnQkUsb0JBRWhCLElBQU1DLEdBQW1CLElBQUlwRixFQUFjLENBQ3pDWixjQUFlLGdCQUNmYSxpQkFrSEYsU0FBaUNvRixHQUNqQ0QsR0FBaUJFLGVBQWMsR0FDN0JuQixFQUFJb0IsZ0JBQWdCRixHQUNqQmhELE1BQUssU0FBQ2dELEdBQ0x4QyxRQUFRQyxJQUFJdUMsR0FDWlQsR0FBWUMsWUFBWSxDQUN0QnRELGNBQWU4RCxFQUFTbEwsS0FDeEJxSCxhQUFjNkQsRUFBU3JDLE1BQ3ZCdkIsV0FBWTRELEVBQVNoQyxZQUl4QlYsT0FBTSxTQUFDQyxHQUNOQyxRQUFRQyxJQUFJRixNQUViNEMsU0FBUSxXQUNQSixHQUFpQkUsZUFBYyxTQWhJckNGLEdBQWlCRCxvQkFHakIsSUFBTU0sR0FBb0IsSUFBSXpGLEVBQWMsQ0FDMUNaLGNBQWUsdUJBQ2ZhLGlCQStIRixTQUFrQ3RHLEdBQ2hDOEwsR0FBa0JILGVBQWMsR0FDaENuQixFQUFJdUIsbUJBQW1CL0wsR0FDdEIwSSxNQUFLLFNBQUMzRyxHQUNMa0osR0FBWUMsWUFBWSxDQUN0QnRELGNBQWU3RixFQUFPdkIsS0FDdEJxSCxhQUFjOUYsRUFBT3NILE1BQ3JCdkIsV0FBWS9GLEVBQU8ySCxZQUl0QlYsT0FBTSxTQUFDQyxHQUNOQyxRQUFRQyxJQUFJRixNQUViNEMsU0FBUSxXQUNQQyxHQUFrQkgsZUFBYyxTQTVJcENHLEdBQWtCTixvQkFHbEIsSUFBTVAsR0FBYyxJQUFJNUQsRUFBUyxDQUMvQkMsaUJBQWtCLGlCQUNsQkMsdUJBQXdCLGtCQUN4QkMsb0JBQXFCLGtCQUlqQndFLEdBQWdCLElBQUk5RixFQUFlLGVBR25DK0YsR0FBeUIsSUFBSWhGLEVBQXNCLENBQ3ZEeEIsY0FBYyxtQkFHaEIsU0FBUzBGLEdBQVduTCxHQUVsQixJQUFNa00sRUFBTyxJQUFJbk0sRUFDZixDQUNFQyxLQUFBQSxFQUNBQyxpQkFBa0IsV0FDaEIrTCxHQUFjRyxLQUFLbk0sSUFFckJHLGlCQUFrQixXQUNoQjhMLEdBQXVCRyxXQUFVLFdBQy9CbEQsUUFBUUMsSUFBSStDLEVBQUtHLGFBQ2pCN0IsRUFDRzhCLFdBQVdKLEVBQUtHLGFBQ2hCM0QsTUFBSyxTQUFDQyxHQUNMc0QsR0FBdUJqRyxRQUN2QmtHLEVBQUtLLHNCQUVOdkQsT0FBTSxTQUFDQyxHQUNOQyxRQUFRQyxJQUFJRixTQUdsQmdELEdBQXVCRSxRQUd6QmpNLGdCQUFpQixTQUFDZ00sR0FFVkEsRUFBS00sVUFDUGhDLEVBQ0dpQyxXQUFXUCxFQUFLRyxhQUVkM0QsTUFBSyxTQUFDQyxHQUFELE9BQ2R1RCxFQUFLUSxlQUFlL0QsTUFDbkJLLE9BQU0sU0FBQ0MsR0FDTkMsUUFBUUMsSUFBSUYsTUFNZHVCLEVBQ09tQyxRQUFRVCxFQUFLRyxhQUVYM0QsTUFBSyxTQUFDQyxHQUFELE9BQ2R1RCxFQUFLUSxlQUFlL0QsTUFDbkJLLE9BQU0sU0FBQ0MsR0FDTkMsUUFBUUMsSUFBSUYsT0FNaEI3SSxjQUFBQSxFQUNBQyxhQUFjLFVBSVp1TSxFQUFjVixFQUFLVyxlQUV6QjlFLEVBQVMrRSxRQUFRRixHQXNFbkJ6QyxFQUFzQjNILGlCQUFpQixTQTFEdkMsV0FPQSxJQUNFLEVBQVFvRixFQUFlQyxFQUFmRCxHQUFSLEVBQXdDcUQsR0FBWThCLGVBQTVDbkYsY0FBZUMsRUFBdkIsRUFBdUJBLGFBQ3ZCeUMsRUFBY3pELE1BQVFlLEVBQ3RCMkMsRUFBYTFELE1BQVFnQixFQVJyQjZDLEVBQXlCc0Msa0JBRXpCdkIsR0FBaUJVLFVBdURuQi9CLEVBQW1CNUgsaUJBQWlCLFNBbEVwQyxXQUNFd0gsRUFBVWpELFFBQ1Y0RCxHQUFzQnFDLGtCQUN0QjFCLEdBQWdCYSxVQWdFbEI5QixFQUF5QjdILGlCQUFpQixTQWhEMUMsV0FDRTBILEVBQVduRCxRQUNYNkQsR0FBZ0NvQyxrQkFDaENsQixHQUFrQkssVSIsInNvdXJjZXMiOlsid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybWF0aW9uLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy91dGlscy9jb25zdGFudHMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XHJcbiAgY29uc3RydWN0b3Ioe1xyXG4gICAgZGF0YSxcclxuICAgIGhhbmRsZUltYWdlQ2xpY2ssXHJcbiAgICBoYW5kbGVMaWtlQ2xpY2ssXHJcbiAgICBoYW5kbGVUcmFzaENsaWNrLFxyXG4gICAgY3VycmVudFVzZXJJZCxcclxuICAgIGNhcmRTZWxlY3RvclxyXG4gIH0pIHtcclxuICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XHJcbiAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xyXG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xyXG4gICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayA9IGhhbmRsZUltYWdlQ2xpY2s7XHJcbiAgICB0aGlzLl9saWtlcyA9IGRhdGEubGlrZXM7XHJcbiAgICB0aGlzLl9oYW5kbGVMaWtlQ2xpY2sgPSBoYW5kbGVMaWtlQ2xpY2s7XHJcbiAgICB0aGlzLl9jYXJkSWQgPSBkYXRhLl9pZDtcclxuICAgIHRoaXMuX2RlbGV0ZUNvbmZpcm1hdGlvbkZvcm0gPSBoYW5kbGVUcmFzaENsaWNrO1xyXG4gICAgdGhpcy5fY3VycmVudFVzZXJJZCA9IGN1cnJlbnRVc2VySWQ7XHJcbiAgICB0aGlzLl9vd25lcklkID0gZGF0YS5vd25lci5faWQ7XHJcbiAgfVxyXG4gIGdldENhcmRJZCgpIHtcclxuICAgIHJldHVybiB0aGlzLl9jYXJkSWQ7XHJcbiAgfVxyXG4gIF9nZXRUZW1wbGF0ZSgpIHtcclxuICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZCcpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG5cclxuICAgIHJldHVybiBjYXJkRWxlbWVudDtcclxuICB9XHJcblxyXG4gIGhhbmRsZURlbGV0ZUNhcmQoKSB7XHJcbiAgICB0aGlzLl9lbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgdGhpcy5fZWxlbWVudCA9IG51bGw7XHJcbiAgfVxyXG4gIGlzTGlrZWQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fbG92ZUljb24uY2xhc3NMaXN0LmNvbnRhaW5zKCdjYXJkX19idXR0b25fYWN0aXZlJyk7XHJcbiAgfVxyXG4gIGhhbmRsZUxpa2VEYXRhKHJlc3VsdCkge1xyXG4gICAgdGhpcy5fbG92ZUljb24uY2xhc3NMaXN0LnRvZ2dsZSgnY2FyZF9fYnV0dG9uX2FjdGl2ZScpO1xyXG4gICAgdGhpcy5fY2FyZExpa2VzQ291bnRlci50ZXh0Q29udGVudCA9IHJlc3VsdC5saWtlcy5sZW5ndGg7XHJcbiAgfVxyXG4gIGdlbmVyYXRlQ2FyZCgpIHtcclxuICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG4gICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fdGl0bGUnKS50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XHJcbiAgICB0aGlzLl9pbWFnZUVsZW1lbnQgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19pbWcnKTtcclxuICAgIHRoaXMuX2ltYWdlRWxlbWVudC5zcmMgPSB0aGlzLl9saW5rO1xyXG4gICAgdGhpcy5faW1hZ2VFbGVtZW50LmFsdCA9IHRoaXMuX25hbWU7XHJcbiAgICB0aGlzLl9pbWFnZUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrKTtcclxuICAgIHRoaXMuX2NhcmRMaWtlc0NvdW50ZXIgPVxyXG4gICAgICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX2xpa2VzLWNvdW50ZXInKTtcclxuICAgIHRoaXMuX2NhcmRMaWtlc0NvdW50ZXIudGV4dENvbnRlbnQgPSB0aGlzLl9saWtlcy5sZW5ndGg7XHJcbiAgICB0aGlzLl9sb3ZlSWNvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX2J1dHRvbicpO1xyXG4gICAgdGhpcy5fdHJhc2hJY29uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fZGVsZXRlJyk7XHJcbiAgICBpZiAodGhpcy5fb3duZXJJZCAhPT0gdGhpcy5fY3VycmVudFVzZXJJZCkge1xyXG4gICAgICB0aGlzLl90cmFzaEljb24ucmVtb3ZlKCk7XHJcbiAgICAgIHRoaXMuX3RyYXNoSWNvbiA9IG51bGw7XHJcbiAgICB9XHJcbiAgICBpZiAodGhpcy5fbGlrZXMuc29tZShpdGVtID0+IGl0ZW0uX2lkID09PSB0aGlzLl9jdXJyZW50VXNlcklkKSkge1xyXG4gICAgICB0aGlzLl9sb3ZlSWNvbi5jbGFzc0xpc3QuYWRkKCdjYXJkX19idXR0b25fYWN0aXZlJyk7XHJcbiAgICB9XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAvLyBsaWtlIGJ1dHRvblxyXG4gICAgdGhpcy5fbG92ZUljb24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUxpa2VDbGljayh0aGlzKTtcclxuICAgIH0pO1xyXG4gICAgLy8gZGVsZXRlIGNhcmRcclxuICAgIGlmICh0aGlzLl90cmFzaEljb24pIHtcclxuICAgICAgdGhpcy5fdHJhc2hJY29uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2RlbGV0ZUNvbmZpcm1hdGlvbkZvcm0odGhpcyk7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICBjb25zdHJ1Y3RvcihzZXR0aW5ncywgZm9ybUVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBzZXR0aW5ncy5pbnB1dFNlbGVjdG9yO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBzZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcclxuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBzZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xyXG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzO1xyXG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IHNldHRpbmdzLmVycm9yQ2xhc3M7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xyXG4gIH1cclxuICBfc2hvd0lucHV0RXJyb3IoZWxlbWVudCwgZXJyb3JNZXNzYWdlKSB7XHJcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPVxyXG4gICAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYC4ke2VsZW1lbnQuaWR9LWlucHV0LWVycm9yYCk7XHJcbiAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xyXG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfTtcclxuICBfaGlkZUlucHV0RXJyb3IoZWxlbWVudCkge1xyXG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID1cclxuICAgICAgICB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAuJHtlbGVtZW50LmlkfS1pbnB1dC1lcnJvcmApO1xyXG4gICAgZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9ICcnO1xyXG4gIH07XHJcblxyXG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XHJcbiAgICAvL3RoaXMuX2lucHV0TGlzdC5zb21lKChlbGVtZW50KSA9PiAhZWxlbWVudC52YWxpZGl0eS52YWxpZCk7XHJcbiAgICByZXR1cm4gWy4uLnRoaXMuX2lucHV0TGlzdF0uc29tZSgoZWxlbWVudCkgPT4gIWVsZW1lbnQudmFsaWRpdHkudmFsaWQpO1xyXG4gIH07XHJcblxyXG5cclxuICBfdG9nZ2xlSW5wdXRFcnJvcihlbGVtZW50KSB7XHJcbiAgICBpZiAoIWVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcclxuXHJcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGVsZW1lbnQsIGVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2UpO1xyXG4gICAgfSBlbHNlIHtcclxuXHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGVsZW1lbnQpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIF90b2dnbGVCdXR0b25TdGF0ZSgpIHtcclxuXHJcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KCkpIHtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgfTtcclxuICB9O1xyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAgICAgdGhpcy5faW5wdXRMaXN0ID1cclxuICAgICAgICBbLi4udGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKV07XHJcbiAgICB0aGlzLl9idXR0b25FbGVtZW50ID1cclxuICAgICAgICB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH07XHJcblxyXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH07XHJcbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xyXG4gICAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoZWxlbWVudCkgPT4ge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihlbGVtZW50KTtcclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyICwgY29udGFpbmVyU2VsZWN0b3J9KSB7XHJcbiAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xyXG4gIH1cclxuICByZW5kZXJJdGVtcygpIHtcclxuICAgIHRoaXMuX2l0ZW1zLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xyXG5cclxuICAgIH0pO1xyXG4gIH1cclxuICBhZGRJdGVtKGVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX2hhbmRsZUVzY0Nsb3NlID0gdGhpcy5faGFuZGxlRXNjQ2xvc2UuYmluZCh0aGlzKTtcbiAgICB0aGlzLl9oYW5kbGVNb3VzZURvd24gPSB0aGlzLl9oYW5kbGVNb3VzZURvd24uYmluZCh0aGlzKTtcbiAgfVxuXG4gIG9wZW4oKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJmb3Jtc19pcy1vcGVuXCIpO1xuICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgdGhpcy5faGFuZGxlTW91c2VEb3duKTtcbiAgfVxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcImZvcm1zX2lzLW9wZW5cIik7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgdGhpcy5faGFuZGxlTW91c2VEb3duKTtcbiAgfVxuXG4gIF9oYW5kbGVNb3VzZURvd24oZXZ0KSB7XG4gICAgaWYgKFxuICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJmb3Jtc1wiKSB8fFxuICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJmb3Jtc19fYnV0dG9uLWNsb3NlXCIpXG4gICAgKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuICB9XG4gIF9oYW5kbGVFc2NDbG9zZShldnQpIHtcbiAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfVxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuXG4gICAgdGhpcy5fcG9wdXBJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybXNfX2ltYWdlXCIpO1xuICAgIHRoaXMuX3BvcHVwSW1hZ2VUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybXNfX2ltYWdlLXRpdGxlXCIpO1xuICB9XG4gIG9wZW4oZGF0YSkge1xuICAgIHRoaXMuX3BvcHVwSW1hZ2Uuc3JjID0gZGF0YS5saW5rO1xuICAgIHRoaXMuX3BvcHVwSW1hZ2UuYWx0ID0gYEltYWdlICR7ZGF0YS5uYW1lfWA7XG4gICAgdGhpcy5fcG9wdXBJbWFnZVRpdGxlLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xuICAgIHN1cGVyLm9wZW4oKTtcbiAgfVxufVxuIiwiXHJcbmltcG9ydCBQb3B1cCBmcm9tICcuL1BvcHVwLmpzJztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3Ioe3BvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXR9KSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2Zvcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmZvcm0nKTtcclxuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xyXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKCcuZm9ybV9faW5wdXQnKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcignLmZvcm1fX2J1dHRvbicpO1xyXG4gICAgdGhpcy5fYnV0dG9uVGV4dCA9IHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudDtcclxuICB9XHJcbiAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgLy8gQ3JlYXRlIGFuIGVtcHR5IG9iamVjdFxyXG4gICAgdGhpcy5fZm9ybVZhbHVlcyA9IHt9O1xyXG5cclxuICAgIC8vIEFkZCB0aGUgdmFsdWVzIG9mIHRoZSBmaWVsZHMgdG8gdGhpcyBvYmplY3RcclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICB0aGlzLl9mb3JtVmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XHJcbiAgICB9KTtcclxuICAgIC8vIFJldHVybiB0aGUgdmFsdWVzIG9iamVjdFxyXG4gICAgcmV0dXJuIHRoaXMuX2Zvcm1WYWx1ZXM7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgKGV2dCkgPT4ge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX2Zvcm0ucmVzZXQoKTtcclxuICAgIHN1cGVyLmNsb3NlKCk7XHJcbiAgfVxyXG4gIHJlbmRlckxvYWRpbmcoaXNMb2FkaW5nKSB7XHJcbiAgICBpZiAoaXNMb2FkaW5nKSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9ICdTYXZpbmcgLi4uJztcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IHRoaXMuX2J1dHRvblRleHQ7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhDb25maXJtYXRpb24gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3Ioe3BvcHVwU2VsZWN0b3J9KXtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG5cclxuICAgIHRoaXMuX3llc0J1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fX2J1dHRvblwiKTtcclxuICB9XHJcbiAgb3Blbigpe1xyXG4gICAgdGhpcy5feWVzQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9oYW5kbGVZZXNTdWJtaXQpO1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG5cclxuICB9XHJcbiAgY2xvc2UoKXtcclxuXHJcbiAgICB0aGlzLl95ZXNCdXR0b24ucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsdGhpcy5faGFuZGxlWWVzU3VibWl0KTtcclxuICAgIHN1cGVyLmNsb3NlKCk7XHJcblxyXG4gIH1cclxuICBzZXRTdWJtaXQoaGFuZGxlWWVzU3VibWl0KXtcclxuICAgIHRoaXMuX2hhbmRsZVllc1N1Ym1pdCA9IGhhbmRsZVllc1N1Ym1pdDtcclxuICB9XHJcblxyXG5cclxuXHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xyXG4gIGNvbnN0cnVjdG9yKHt1c2VyTmFtZVNlbGVjdG9yLCB1c2VyT2NjdXBhdGlvblNlbGVjdG9yLCB1c2VyUGljdHVyZVNlbGVjdG9yfSkge1xyXG4gICAgdGhpcy5fcHJvZmlsZU5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHVzZXJOYW1lU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fcHJvZmlsZUpvYiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodXNlck9jY3VwYXRpb25TZWxlY3Rvcik7XHJcbiAgICB0aGlzLl91c2VyUGljdHVyZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodXNlclBpY3R1cmVTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHVzZXJJbnB1dE5hbWU6IHRoaXMuX3Byb2ZpbGVOYW1lLnRleHRDb250ZW50LFxyXG4gICAgICB1c2VySW5wdXRKb2I6IHRoaXMuX3Byb2ZpbGVKb2IudGV4dENvbnRlbnRcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBzZXRVc2VySW5mbyh7dXNlcklucHV0TmFtZSwgdXNlcklucHV0Sm9iLCB1c2VyQXZhdGFyfSkge1xyXG4gICAgdGhpcy5fcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSB1c2VySW5wdXROYW1lO1xyXG4gICAgdGhpcy5fcHJvZmlsZUpvYi50ZXh0Q29udGVudCA9IHVzZXJJbnB1dEpvYjtcclxuICAgIHRoaXMuX3VzZXJQaWN0dXJlLnNyYyA9IHVzZXJBdmF0YXI7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBDYXJkIGZyb20gXCIuLi9zY3JpcHRzL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xyXG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vc2NyaXB0cy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcclxuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL3NjcmlwdHMvY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vc2NyaXB0cy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9zY3JpcHRzL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoQ29uZmlybWF0aW9uIGZyb20gXCIuLi9zY3JpcHRzL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybWF0aW9uLmpzXCI7XHJcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vc2NyaXB0cy9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XHJcbmltcG9ydCBBcGkgZnJvbSBcIi4uL3NjcmlwdHMvY29tcG9uZW50cy9BcGkuanNcIjtcclxuaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcclxuaW1wb3J0IHtcclxuICBmb3JtVmFsaWRhdGlvblNldHRpbmdzLFxyXG4gIGVkaXRQcm9maWxlRm9ybSxcclxuICBhZGRJbWFnZUZvcm0sXHJcbiAgaW1hZ2VGb3JtLFxyXG4gIGF2YXRhckZvcm0sXHJcbiAgcHJvZmlsZUF2YXRhckZvcm0sXHJcbiAgb3BlblByb2ZpbGVFZGl0QnV0dG9uLFxyXG4gIG9wZW5JbWFnZUFkZEJ1dHRvbixcclxuICBlZGl0UHJvZmlsZVBpY3R1cmVCdXR0b24sXHJcbiAgdXNlck5hbWVJbnB1dCxcclxuICB1c2VySm9iSW5wdXQsXHJcbn0gZnJvbSBcIi4uL3NjcmlwdHMvdXRpbHMvY29uc3RhbnRzLmpzXCI7XHJcblxyXG5cclxubGV0IGNhcmRMaXN0O1xyXG5sZXQgY3VycmVudFVzZXJJZDtcclxuY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwLTEyXCIsXHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogXCI2NmQwNjBjMy1hOTJiLTQ5ZDAtYWRkNS1kN2UyOWJmNDExYzlcIixcclxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gIH0sXHJcbn0pO1xyXG4vLyBmb3JtIHZhbGlkYXRpb25cclxuY29uc3QgZWRpdFByb2ZpbGVGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoXHJcbiAgZm9ybVZhbGlkYXRpb25TZXR0aW5ncyxcclxuICBlZGl0UHJvZmlsZUZvcm1cclxuKTtcclxuY29uc3QgYWRkSW1hZ2VGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoXHJcbiAgZm9ybVZhbGlkYXRpb25TZXR0aW5ncyxcclxuICBhZGRJbWFnZUZvcm1cclxuKTtcclxuY29uc3QgZWRpdFByb2ZpbGVQaWN0dXJlRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFxyXG4gIGZvcm1WYWxpZGF0aW9uU2V0dGluZ3MsXHJcbiAgcHJvZmlsZUF2YXRhckZvcm1cclxuKTtcclxuZWRpdFByb2ZpbGVGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuYWRkSW1hZ2VGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuZWRpdFByb2ZpbGVQaWN0dXJlRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbi8vaW5pdCBjYXJkcywgdXNlciBpbmZvXHJcbmFwaS5wcm9taXNlQWxsKClcclxuLnRoZW4oKFt1c2VyLGNhcmREYXRhXSkgPT4ge1xyXG4gIHByb2ZpbGVJbmZvLnNldFVzZXJJbmZvKHtcclxuICAgIHVzZXJJbnB1dE5hbWU6IHVzZXIubmFtZSxcclxuICAgIHVzZXJJbnB1dEpvYjogdXNlci5hYm91dCxcclxuICAgIHVzZXJBdmF0YXI6IHVzZXIuYXZhdGFyLH0pO1xyXG5cclxuICBjdXJyZW50VXNlcklkID0gdXNlci5faWQ7XHJcbiAgY2FyZExpc3QgPSBuZXcgU2VjdGlvbihcclxuICAgIHtcclxuICAgICAgaXRlbXM6IGNhcmREYXRhLFxyXG4gICAgICByZW5kZXJlcjogcmVuZGVyQ2FyZCxcclxuICAgICAgY29udGFpbmVyU2VsZWN0b3I6IFwiLmNhcmRzX19jb250YWluZXJcIix9XHJcbiAgKTtcclxuXHJcbiAgY2FyZExpc3QucmVuZGVySXRlbXMoKTtcclxuXHJcbn0pXHJcbi5jYXRjaChlcnIgPT4gY29uc29sZS5lcnJvcihgRXJyb3Igd2hpbGUgZXhlY3V0aW5nOiAke2Vycn1gKSk7XHJcblxyXG4vL2luaXQgcG9wdXAgYWRkIG5ldyBpbWFnZSAqXHJcbmNvbnN0IGFkZE5ld0ltYWdlRm9ybSA9IG5ldyBQb3B1cFdpdGhGb3JtKHtcclxuICBwb3B1cFNlbGVjdG9yOiBcIiNpbWctYWRkXCIsXHJcbiAgaGFuZGxlRm9ybVN1Ym1pdDogKGRhdGEpID0+IHtcclxuICAgICBhcGkuYWRkTmV3Q2FyZChkYXRhKVxyXG4gICAgLnRoZW4oZGF0YSA9PlxyXG4gICAgcmVuZGVyQ2FyZChkYXRhKSk7XHJcbiAgfSxcclxufSk7XHJcbmFkZE5ld0ltYWdlRm9ybS5zZXRFdmVudExpc3RlbmVycygpO1xyXG4vL2luaXQgcG9wdXAgdG8gdXBkYXRlIHByb2ZpbGUgaW5mb1xyXG5jb25zdCBlZGl0VXNlckluZm9Gb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0oe1xyXG4gIHBvcHVwU2VsZWN0b3I6IFwiI2VkaXQtcHJvZmlsZVwiLFxyXG4gIGhhbmRsZUZvcm1TdWJtaXQ6IGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0LFxyXG59KTtcclxuZWRpdFVzZXJJbmZvRm9ybS5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuLy9pbml0IHBvcHVwIHRvIGNoYW5nZSBhdmF0YXJcclxuY29uc3QgZWRpdFVzZXJJbWFnZUZvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybSh7XHJcbiAgcG9wdXBTZWxlY3RvcjogXCIjdXBkYXRlLWF2YXRhci1wb3B1cFwiLFxyXG4gIGhhbmRsZUZvcm1TdWJtaXQ6IGhhbmRsZVByb2ZpbGVJbWFnZVN1Ym1pdCxcclxufSk7XHJcbmVkaXRVc2VySW1hZ2VGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4vL2luaXQgdXNlciBpbmZvXHJcbmNvbnN0IHByb2ZpbGVJbmZvID0gbmV3IFVzZXJJbmZvKHtcclxuICB1c2VyTmFtZVNlbGVjdG9yOiBcIi5wcm9maWxlX19uYW1lXCIsXHJcbiAgdXNlck9jY3VwYXRpb25TZWxlY3RvcjogXCIucHJvZmlsZV9fYWJvdXRcIixcclxuICB1c2VyUGljdHVyZVNlbGVjdG9yOiBcIi5wcm9maWxlX19pbWdcIixcclxufSk7XHJcblxyXG4vL2luaXQgcHJldmlldyBpbWFnZVxyXG5jb25zdCBjYXJkU2hvd0ltYWdlID0gbmV3IFBvcHVwV2l0aEltYWdlKFwiI2ltYWdlLXNob3dcIik7XHJcblxyXG4vL2luaXQgY29uZmlybWF0aW9uIHBvcHVwIHRvIGRlbGV0ZSBjYXJkXHJcbmNvbnN0IGRlbGV0ZUNvbmZpcm1hdGlvbkZvcm0gPSBuZXcgUG9wdXBXaXRoQ29uZmlybWF0aW9uKHtcclxuICBwb3B1cFNlbGVjdG9yOlwiI2NvbmZpcm0tcG9wdXBcIn0pO1xyXG5cclxuLy8gcmVuZGVyIGNhcmRcclxuZnVuY3Rpb24gcmVuZGVyQ2FyZChkYXRhKSB7XHJcblxyXG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcclxuICAgIHtcclxuICAgICAgZGF0YSxcclxuICAgICAgaGFuZGxlSW1hZ2VDbGljazogKCkgPT4ge1xyXG4gICAgICAgIGNhcmRTaG93SW1hZ2Uub3BlbihkYXRhKTtcclxuICAgICAgfSxcclxuICAgICAgaGFuZGxlVHJhc2hDbGljazogKCkgPT4ge1xyXG4gICAgICAgIGRlbGV0ZUNvbmZpcm1hdGlvbkZvcm0uc2V0U3VibWl0KCgpID0+IHtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKGNhcmQuZ2V0Q2FyZElkKCkpO1xyXG4gICAgICAgICAgYXBpXHJcbiAgICAgICAgICAgIC5kZWxldGVDYXJkKGNhcmQuZ2V0Q2FyZElkKCkpXHJcbiAgICAgICAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICAgICAgICBkZWxldGVDb25maXJtYXRpb25Gb3JtLmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgY2FyZC5oYW5kbGVEZWxldGVDYXJkKCk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgZGVsZXRlQ29uZmlybWF0aW9uRm9ybS5vcGVuKCk7XHJcblxyXG4gICAgICB9LFxyXG4gICAgICBoYW5kbGVMaWtlQ2xpY2s6IChjYXJkKSA9PiB7XHJcblxyXG4gICAgICAgICAgaWYgKGNhcmQuaXNMaWtlZCgpKSB7XHJcbiAgICAgICAgICAgIGFwaVxyXG4gICAgICAgICAgICAgIC5yZW1vdmVMaWtlKGNhcmQuZ2V0Q2FyZElkKCkpXHJcblxyXG4gICAgICAgICAgICAgICAgLnRoZW4oKHJlcykgPT5cclxuICAgICAgICBjYXJkLmhhbmRsZUxpa2VEYXRhKHJlcykpXHJcbiAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICAgICAgfSk7XHJcblxyXG5cclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICBhcGlcclxuICAgICAgICAgICAgICAuYWRkTGlrZShjYXJkLmdldENhcmRJZCgpKVxyXG5cclxuICAgICAgICAgICAgICAgIC50aGVuKChyZXMpID0+XHJcbiAgICAgICAgY2FyZC5oYW5kbGVMaWtlRGF0YShyZXMpKVxyXG4gICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuXHJcbiAgICAgIH1cclxuICAgIH0sXHJcbiAgICAgIGN1cnJlbnRVc2VySWQsXHJcbiAgICAgIGNhcmRTZWxlY3RvcjogXCIjY2FyZFwiLFxyXG4gICAgfSxcclxuXHJcbiAgKTtcclxuICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmQuZ2VuZXJhdGVDYXJkKCk7XHJcbiAvLyBjb25zb2xlLmxvZyhjYXJkKTtcclxuICBjYXJkTGlzdC5hZGRJdGVtKGNhcmRFbGVtZW50KTtcclxufVxyXG5cclxuXHJcbi8vIGZ1bmN0aW9uIHNob3cgYWRkIGltYWdlIGZvcm1cclxuZnVuY3Rpb24gb3BlbkFkZEltYWdlRm9ybSgpIHtcclxuICBpbWFnZUZvcm0ucmVzZXQoKTsgLy8gcmVzZXQgZm9ybVxyXG4gIGFkZEltYWdlRm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcclxuICBhZGROZXdJbWFnZUZvcm0ub3BlbigpO1xyXG59XHJcblxyXG4vLyBmdW5jdGlvbiBvcGVuIGVkaXQgZm9ybVxyXG5mdW5jdGlvbiBvcGVuRWRpdFByb2ZpbGVGb3JtKCkge1xyXG4gIGZpbGxQcm9maWxlRm9ybSgpO1xyXG4gIGVkaXRQcm9maWxlRm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcclxuXHJcbiAgZWRpdFVzZXJJbmZvRm9ybS5vcGVuKCk7XHJcbn1cclxuLy8gcHJlZmlsbCB0aGUgcHJvZmlsZSBmb3JtXHJcbmZ1bmN0aW9uIGZpbGxQcm9maWxlRm9ybSgpIHtcclxuICBjb25zdCB7IHVzZXJJbnB1dE5hbWUsIHVzZXJJbnB1dEpvYiB9ID0gcHJvZmlsZUluZm8uZ2V0VXNlckluZm8oKTtcclxuICB1c2VyTmFtZUlucHV0LnZhbHVlID0gdXNlcklucHV0TmFtZTtcclxuICB1c2VySm9iSW5wdXQudmFsdWUgPSB1c2VySW5wdXRKb2I7XHJcbn1cclxuZnVuY3Rpb24gb3BlbkVkaXRQcm9maWxlUGljdHVyZUZvcm0oKXtcclxuICBhdmF0YXJGb3JtLnJlc2V0KCk7XHJcbiAgZWRpdFByb2ZpbGVQaWN0dXJlRm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcclxuICBlZGl0VXNlckltYWdlRm9ybS5vcGVuKCk7XHJcbn1cclxuLy8gZnVuY3Rpb24gdG8gc3VibWl0IGVkaXQgcHJvZmlsZSBpbmZvXHJcbmZ1bmN0aW9uIGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0KHVzZXJEYXRhKSB7XHJcbmVkaXRVc2VySW5mb0Zvcm0ucmVuZGVyTG9hZGluZyh0cnVlKTtcclxuICBhcGkuZWRpdFByb2ZpbGVJbmZvKHVzZXJEYXRhKVxyXG4gICAgLnRoZW4oKHVzZXJEYXRhKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKHVzZXJEYXRhKTtcclxuICAgICAgcHJvZmlsZUluZm8uc2V0VXNlckluZm8oe1xyXG4gICAgICAgIHVzZXJJbnB1dE5hbWU6IHVzZXJEYXRhLm5hbWUsXHJcbiAgICAgICAgdXNlcklucHV0Sm9iOiB1c2VyRGF0YS5hYm91dCxcclxuICAgICAgICB1c2VyQXZhdGFyOiB1c2VyRGF0YS5hdmF0YXJcclxuICAgICAgfSk7XHJcblxyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGVycik7IC8vIGxvZyB0aGUgZXJyb3IgdG8gdGhlIGNvbnNvbGVcclxuICAgIH0pXHJcbiAgICAuZmluYWxseSgoKT0+e1xyXG4gICAgICBlZGl0VXNlckluZm9Gb3JtLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG4gIC8vZnVuY3Rpb24gdG8gaGFuZGxlIGVkaXRVc2VySW1hZ2VGb3JtXHJcbmZ1bmN0aW9uIGhhbmRsZVByb2ZpbGVJbWFnZVN1Ym1pdChkYXRhKXtcclxuICBlZGl0VXNlckltYWdlRm9ybS5yZW5kZXJMb2FkaW5nKHRydWUpO1xyXG4gIGFwaS5lZGl0UHJvZmlsZVBpY3R1cmUoZGF0YSlcclxuICAudGhlbigocmVzdWx0KT0+IHtcclxuICAgIHByb2ZpbGVJbmZvLnNldFVzZXJJbmZvKHtcclxuICAgICAgdXNlcklucHV0TmFtZTogcmVzdWx0Lm5hbWUsXHJcbiAgICAgIHVzZXJJbnB1dEpvYjogcmVzdWx0LmFib3V0LFxyXG4gICAgICB1c2VyQXZhdGFyOiByZXN1bHQuYXZhdGFyXHJcbiAgICB9KTtcclxuXHJcbiAgfSlcclxuICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgY29uc29sZS5sb2coZXJyKTsgLy8gbG9nIHRoZSBlcnJvciB0byB0aGUgY29uc29sZVxyXG4gIH0pXHJcbiAgLmZpbmFsbHkoKCk9PntcclxuICAgIGVkaXRVc2VySW1hZ2VGb3JtLnJlbmRlckxvYWRpbmcoZmFsc2UpXHJcbiAgfSlcclxufVxyXG5cclxuLy8gZXZlbnQgbGlzdG5lcmVuc1xyXG5vcGVuUHJvZmlsZUVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIG9wZW5FZGl0UHJvZmlsZUZvcm0pO1xyXG5vcGVuSW1hZ2VBZGRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIG9wZW5BZGRJbWFnZUZvcm0pO1xyXG5lZGl0UHJvZmlsZVBpY3R1cmVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIG9wZW5FZGl0UHJvZmlsZVBpY3R1cmVGb3JtKTtcclxuXHJcblxyXG4vLyAgZmV0Y2goXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwLTEyL2NhcmRzXCIsIHtcclxuLy8gICBoZWFkZXJzOiB7XHJcbi8vICAgICBhdXRob3JpemF0aW9uOiBcIjY2ZDA2MGMzLWE5MmItNDlkMC1hZGQ1LWQ3ZTI5YmY0MTFjOVwiXHJcbi8vICAgfVxyXG4vLyB9KVxyXG4vLyAgIC50aGVuKHJlcyA9PiByZXMuanNvbigpKVxyXG4vLyAgIC50aGVuKChyZXN1bHQpID0+IHtcclxuLy8gICAgIGNvbnNvbGUubG9nKHJlc3VsdCk7XHJcbi8vICAgfSk7XHJcbi8vICAgZmV0Y2ggKFwiaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9ncm91cC0xMi91c2Vycy9tZVwiLCB7XHJcbi8vICAgaGVhZGVyczoge1xyXG4vLyAgICAgYXV0aG9yaXphdGlvbjogXCI2NmQwNjBjMy1hOTJiLTQ5ZDAtYWRkNS1kN2UyOWJmNDExYzlcIlxyXG4vLyAgIH1cclxuLy8gfSlcclxuLy8gICAudGhlbihyZXMgPT4gcmVzLmpzb24oKSlcclxuLy8gICAudGhlbigocmVzdWx0KSA9PiB7XHJcbi8vICAgICBjb25zb2xlLmxvZyhyZXN1bHQpO1xyXG4vLyAgIH0pO1xyXG4vKiBmZXRjaChcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvZ3JvdXAtMTIvdXNlcnMvbWVcIiwge1xyXG4gIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gIGhlYWRlcnM6IHtcclxuICAgIGF1dGhvcml6YXRpb246IFwiNjZkMDYwYzMtYTkyYi00OWQwLWFkZDUtZDdlMjliZjQxMWM5XCIsXHJcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIlxyXG4gIH0sXHJcbiAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgbmFtZTogXCJOdXJpeWEgQWtobWVkb3ZhXCIsXHJcbiAgICBhYm91dDogXCJTb2Z0d2FyZSBEZXZlbG9wZXIsIGV4cGxvcmVyLCBtb21cIlxyXG4gIH0pXHJcbn0pOyAqL1xyXG5cclxuLy90b0RvXHJcblxyXG4vL2xpa2VzIGZ1bmN0aW9uXHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XHJcbiAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBoZWFkZXJzIH0pIHtcclxuICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xyXG4gICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XHJcbiAgfVxyXG4gIHByb21pc2VBbGwoKXtcclxuICByZXR1cm4gUHJvbWlzZS5hbGwoW3RoaXMuZ2V0VXNlckRhdGEoKSwgdGhpcy5nZXRJbml0aWFsQ2FyZHMoKV0pXHJcblxyXG4gIH1cclxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7IGhlYWRlcnM6IHRoaXMuX2hlYWRlcnN9KVxyXG4gICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIGlmIHRoZSBzZXJ2ZXIgcmV0dXJucyBhbiBlcnJvciwgcmVqZWN0IHRoZSBwcm9taXNlXHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGVycik7IC8vIGxvZyB0aGUgZXJyb3IgdG8gdGhlIGNvbnNvbGVcclxuICAgICAgfSk7XHJcbiAgfVxyXG4gIGdldFVzZXJEYXRhKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCxcclxuICAgICAgeyBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzfVxyXG4gICAgKVxyXG4gICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIGlmIHRoZSBzZXJ2ZXIgcmV0dXJucyBhbiBlcnJvciwgcmVqZWN0IHRoZSBwcm9taXNlXHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICB9KVxyXG5cclxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICBjb25zb2xlLmxvZyhlcnIpOyAvLyBsb2cgdGhlIGVycm9yIHRvIHRoZSBjb25zb2xlXHJcbiAgICAgIH0pO1xyXG4gIH1cclxuICBlZGl0UHJvZmlsZUluZm8oe3VzZXJuYW1lLCBhYm91dH0pIHtcclxuICAgIC8vUEFUQ0ggaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9ncm91cElkL3VzZXJzL21lXHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgIG5hbWU6IHVzZXJuYW1lLFxyXG4gICAgICBhYm91dDogYWJvdXQsXHJcbiAgICB9KVxyXG4gIH0pXHJcbiAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgaWYgKHJlcy5vaykge1xyXG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgIH1cclxuICAgIC8vIGlmIHRoZSBzZXJ2ZXIgcmV0dXJucyBhbiBlcnJvciwgcmVqZWN0IHRoZSBwcm9taXNlXHJcbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgY29uc29sZS5sb2coZXJyKTsgLy8gbG9nIHRoZSBlcnJvciB0byB0aGUgY29uc29sZVxyXG4gIH0pO1xyXG4gIH1cclxuICBlZGl0UHJvZmlsZVBpY3R1cmUoe2F2YXRhcn0pIHtcclxuICAvL1BBVENIIGh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvZ3JvdXBJZC91c2Vycy9tZS9hdmF0YXJcclxuICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgYXZhdGFyXHJcbiAgfSlcclxufSlcclxuLnRoZW4oKHJlcykgPT4ge1xyXG4gIGlmIChyZXMub2spIHtcclxuICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gIH1cclxuICAvLyBpZiB0aGUgc2VydmVyIHJldHVybnMgYW4gZXJyb3IsIHJlamVjdCB0aGUgcHJvbWlzZVxyXG4gIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxufSlcclxuLmNhdGNoKChlcnIpID0+IHtcclxuICBjb25zb2xlLmxvZyhlcnIpOyAvLyBsb2cgdGhlIGVycm9yIHRvIHRoZSBjb25zb2xlXHJcbn0pO1xyXG4gIH1cclxuICBhZGROZXdDYXJkKHtuYW1lLGxpbmt9KSB7XHJcbiAgICAvL1BPU1QgaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9ncm91cElkL2NhcmRzXHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgbmFtZSxcclxuICAgICAgbGluayxcclxuICAgIH0pXHJcbiAgfSlcclxuICAudGhlbigocmVzKSA9PiB7XHJcbiAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgfVxyXG4gICAgLy8gaWYgdGhlIHNlcnZlciByZXR1cm5zIGFuIGVycm9yLCByZWplY3QgdGhlIHByb21pc2VcclxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICB9KVxyXG4gIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICBjb25zb2xlLmxvZyhlcnIpOyAvLyBsb2cgdGhlIGVycm9yIHRvIHRoZSBjb25zb2xlXHJcbiAgfSk7XHJcbiAgfVxyXG4gIGRlbGV0ZUNhcmQoY2FyZElkKSB7XHJcbiAgICAvL0RFTEVURSBodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwSWQvY2FyZHMvY2FyZElkXHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9YCxcclxuICAgIHsgIG1ldGhvZDpcIkRFTEVURVwiLFxyXG4gICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc30pXHJcbiAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gaWYgdGhlIHNlcnZlciByZXR1cm5zIGFuIGVycm9yLCByZWplY3QgdGhlIHByb21pc2VcclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5sb2coZXJyKTsgLy8gbG9nIHRoZSBlcnJvciB0byB0aGUgY29uc29sZVxyXG4gICAgICB9KTtcclxuXHJcbiAgfVxyXG4gIGFkZExpa2UoY2FyZElkKSB7XHJcbiAgICAvL1BVVCBodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwSWQvY2FyZHMvbGlrZXMvY2FyZElkXHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvbGlrZXMvJHtjYXJkSWR9YCxcclxuICAgICAgICB7ICBtZXRob2Q6XCJQVVRcIixcclxuICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnN9KVxyXG4gICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgLy9jb25zb2xlLmxvZyhyZXMpO1xyXG4gICAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBpZiB0aGUgc2VydmVyIHJldHVybnMgYW4gZXJyb3IsIHJlamVjdCB0aGUgcHJvbWlzZVxyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICBjb25zb2xlLmxvZyhlcnIpOyAvLyBsb2cgdGhlIGVycm9yIHRvIHRoZSBjb25zb2xlXHJcbiAgICAgIH0pO1xyXG4gIH1cclxuICByZW1vdmVMaWtlKGNhcmRJZCkge1xyXG4gICAgLy9ERUxFVEUgaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9ncm91cElkL2NhcmRzL2xpa2VzL2NhcmRJZFxyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzL2xpa2VzLyR7Y2FyZElkfWAsXHJcbiAgICB7ICBtZXRob2Q6XCJERUxFVEVcIixcclxuICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnN9KVxyXG4gICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIGlmIHRoZSBzZXJ2ZXIgcmV0dXJucyBhbiBlcnJvciwgcmVqZWN0IHRoZSBwcm9taXNlXHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGVycik7IC8vIGxvZyB0aGUgZXJyb3IgdG8gdGhlIGNvbnNvbGVcclxuICAgICAgfSk7XHJcbiAgfVxyXG5cclxufVxyXG4iLCJjb25zdCBmb3JtVmFsaWRhdGlvblNldHRpbmdzID0ge1xyXG4gIGZvcm1TZWxlY3RvcjogJy5mb3JtcycsXHJcbiAgaW5wdXRTZWxlY3RvcjogJy5mb3JtX19pbnB1dCcsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6ICcuZm9ybV9fYnV0dG9uJyxcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiAnZm9ybV9fYnV0dG9uX2Rpc2FibGVkJyxcclxuICBpbnB1dEVycm9yQ2xhc3M6ICdmb3JtX19pbnB1dF90eXBlX2Vycm9yJyxcclxuICBlcnJvckNsYXNzOiAnZm9ybV9fZXJyb3ItdGV4dF9hY3RpdmUnXHJcbn07XHJcblxyXG4vLyBXcmFwcGVyc1xyXG5jb25zdCBjYXJkc0NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkc19fY29udGFpbmVyJyk7XHJcbmNvbnN0IGVkaXRQcm9maWxlRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNlZGl0LXByb2ZpbGUnKTtcclxuY29uc3QgYWRkSW1hZ2VGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2ltZy1hZGQnKTtcclxuY29uc3QgaW1hZ2VGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2FkZC1mb3JtJyk7XHJcbmNvbnN0IHByb2ZpbGVGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2VkaXQtZm9ybScpO1xyXG5jb25zdCBwcm9maWxlQXZhdGFyRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjdXBkYXRlLWF2YXRhci1wb3B1cFwiKTtcclxuY29uc3QgYXZhdGFyRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYXZhdGFyLWZvcm1cIik7XHJcblxyXG4vLyBidXR0b25zXHJcbmNvbnN0IG9wZW5Qcm9maWxlRWRpdEJ1dHRvbiA9XHJcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fYnV0dG9uLW5hbWUtZWRpdCcpO1xyXG5jb25zdCBvcGVuSW1hZ2VBZGRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fYnV0dG9uLWFkZCcpO1xyXG5jb25zdCBlZGl0UHJvZmlsZVBpY3R1cmVCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2ltZy1pY29uXCIpO1xyXG5jb25zdCBjbG9zZUVkaXRGb3JtQnV0dG9uID1cclxuICAgIGVkaXRQcm9maWxlRm9ybS5xdWVyeVNlbGVjdG9yKCcuZm9ybXNfX2J1dHRvbi1jbG9zZScpO1xyXG5cclxuY29uc3QgY2xvc2VBZGRJbWFnZUZvcm1CdXR0b24gPVxyXG4gICAgYWRkSW1hZ2VGb3JtLnF1ZXJ5U2VsZWN0b3IoJy5mb3Jtc19fYnV0dG9uLWNsb3NlJyk7XHJcblxyXG4vLyBwcm9maWxlIERPTSBub2RlcyB1cGRhdGVzIGluZm8gb2YgdGhlIHByb2ZpbGVcclxuY29uc3QgcHJvZmlsZU5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fbmFtZScpO1xyXG5jb25zdCBwcm9maWxlSm9iID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2Fib3V0Jyk7XHJcblxyXG4vLyBmb3JtIGRhdGEgYW5kIGVsZW1lbnRzXHJcbmNvbnN0IHVzZXJOYW1lSW5wdXQgPSBlZGl0UHJvZmlsZUZvcm0ucXVlcnlTZWxlY3RvcignI3VzZXJuYW1lJyk7XHJcbmNvbnN0IHVzZXJKb2JJbnB1dCA9IGVkaXRQcm9maWxlRm9ybS5xdWVyeVNlbGVjdG9yKCcjYWJvdXQnKTtcclxuY29uc3QgaW5wdXRJbWFnZVBsYWNlTmFtZSA9IGFkZEltYWdlRm9ybS5xdWVyeVNlbGVjdG9yKCcjdGl0bGUnKTtcclxuY29uc3QgaW5wdXRJbWFnZVVybCA9IGFkZEltYWdlRm9ybS5xdWVyeVNlbGVjdG9yKCcjaW1hZ2UtbGluaycpO1xyXG5cclxuXHJcblxyXG5leHBvcnQgeyBmb3JtVmFsaWRhdGlvblNldHRpbmdzLCBjYXJkc0NvbnRhaW5lciwgZWRpdFByb2ZpbGVGb3JtLCBhZGRJbWFnZUZvcm0sIGltYWdlRm9ybSwgcHJvZmlsZUZvcm0sYXZhdGFyRm9ybSxwcm9maWxlQXZhdGFyRm9ybSwgb3BlblByb2ZpbGVFZGl0QnV0dG9uLCBlZGl0UHJvZmlsZVBpY3R1cmVCdXR0b24sb3BlbkltYWdlQWRkQnV0dG9uLCBjbG9zZUVkaXRGb3JtQnV0dG9uLCBjbG9zZUFkZEltYWdlRm9ybUJ1dHRvbiwgcHJvZmlsZU5hbWUsIHByb2ZpbGVKb2IsIHVzZXJOYW1lSW5wdXQsIHVzZXJKb2JJbnB1dCwgaW5wdXRJbWFnZVBsYWNlTmFtZSwgaW5wdXRJbWFnZVVybH07XHJcblxyXG5cclxuIl0sIm5hbWVzIjpbIkNhcmQiLCJkYXRhIiwiaGFuZGxlSW1hZ2VDbGljayIsImhhbmRsZUxpa2VDbGljayIsImhhbmRsZVRyYXNoQ2xpY2siLCJjdXJyZW50VXNlcklkIiwiY2FyZFNlbGVjdG9yIiwidGhpcyIsIl9uYW1lIiwibmFtZSIsIl9saW5rIiwibGluayIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlSW1hZ2VDbGljayIsIl9saWtlcyIsImxpa2VzIiwiX2hhbmRsZUxpa2VDbGljayIsIl9jYXJkSWQiLCJfaWQiLCJfZGVsZXRlQ29uZmlybWF0aW9uRm9ybSIsIl9jdXJyZW50VXNlcklkIiwiX293bmVySWQiLCJvd25lciIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJfZWxlbWVudCIsInJlbW92ZSIsIl9sb3ZlSWNvbiIsImNsYXNzTGlzdCIsImNvbnRhaW5zIiwicmVzdWx0IiwidG9nZ2xlIiwiX2NhcmRMaWtlc0NvdW50ZXIiLCJ0ZXh0Q29udGVudCIsImxlbmd0aCIsIl9nZXRUZW1wbGF0ZSIsIl9pbWFnZUVsZW1lbnQiLCJzcmMiLCJhbHQiLCJhZGRFdmVudExpc3RlbmVyIiwiX3RyYXNoSWNvbiIsInNvbWUiLCJpdGVtIiwiYWRkIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiRm9ybVZhbGlkYXRvciIsInNldHRpbmdzIiwiZm9ybUVsZW1lbnQiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfZm9ybUVsZW1lbnQiLCJlbGVtZW50IiwiZXJyb3JNZXNzYWdlIiwiZXJyb3JFbGVtZW50IiwiaWQiLCJfaW5wdXRMaXN0IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oaWRlSW5wdXRFcnJvciIsIl9zaG93SW5wdXRFcnJvciIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2hhc0ludmFsaWRJbnB1dCIsIl9idXR0b25FbGVtZW50IiwiZGlzYWJsZWQiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsImlucHV0RWxlbWVudCIsIl90b2dnbGVJbnB1dEVycm9yIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiZXZ0IiwicHJldmVudERlZmF1bHQiLCJTZWN0aW9uIiwiaXRlbXMiLCJyZW5kZXJlciIsImNvbnRhaW5lclNlbGVjdG9yIiwiX2l0ZW1zIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsInByZXBlbmQiLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXBFbGVtZW50IiwiX2hhbmRsZUVzY0Nsb3NlIiwiYmluZCIsIl9oYW5kbGVNb3VzZURvd24iLCJyZW1vdmVFdmVudExpc3RlbmVyIiwidGFyZ2V0IiwiY2xvc2UiLCJrZXkiLCJQb3B1cFdpdGhJbWFnZSIsIl9wb3B1cEltYWdlIiwiX3BvcHVwSW1hZ2VUaXRsZSIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0IiwiX2Zvcm0iLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9zdWJtaXRCdXR0b24iLCJfYnV0dG9uVGV4dCIsIl9mb3JtVmFsdWVzIiwiaW5wdXQiLCJ2YWx1ZSIsIl9nZXRJbnB1dFZhbHVlcyIsInJlc2V0IiwiaXNMb2FkaW5nIiwiUG9wdXBXaXRoQ29uZmlybWF0aW9uIiwiX3llc0J1dHRvbiIsIl9oYW5kbGVZZXNTdWJtaXQiLCJoYW5kbGVZZXNTdWJtaXQiLCJVc2VySW5mbyIsInVzZXJOYW1lU2VsZWN0b3IiLCJ1c2VyT2NjdXBhdGlvblNlbGVjdG9yIiwidXNlclBpY3R1cmVTZWxlY3RvciIsIl9wcm9maWxlTmFtZSIsIl9wcm9maWxlSm9iIiwiX3VzZXJQaWN0dXJlIiwidXNlcklucHV0TmFtZSIsInVzZXJJbnB1dEpvYiIsInVzZXJBdmF0YXIiLCJjYXJkTGlzdCIsIkFwaSIsImJhc2VVcmwiLCJoZWFkZXJzIiwiX2Jhc2VVcmwiLCJfaGVhZGVycyIsIlByb21pc2UiLCJhbGwiLCJnZXRVc2VyRGF0YSIsImdldEluaXRpYWxDYXJkcyIsImZldGNoIiwidGhlbiIsInJlcyIsIm9rIiwianNvbiIsInJlamVjdCIsInN0YXR1cyIsImNhdGNoIiwiZXJyIiwiY29uc29sZSIsImxvZyIsInVzZXJuYW1lIiwiYWJvdXQiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImF2YXRhciIsImNhcmRJZCIsImZvcm1WYWxpZGF0aW9uU2V0dGluZ3MiLCJmb3JtU2VsZWN0b3IiLCJlZGl0UHJvZmlsZUZvcm0iLCJhZGRJbWFnZUZvcm0iLCJpbWFnZUZvcm0iLCJwcm9maWxlQXZhdGFyRm9ybSIsImF2YXRhckZvcm0iLCJvcGVuUHJvZmlsZUVkaXRCdXR0b24iLCJvcGVuSW1hZ2VBZGRCdXR0b24iLCJlZGl0UHJvZmlsZVBpY3R1cmVCdXR0b24iLCJ1c2VyTmFtZUlucHV0IiwidXNlckpvYklucHV0IiwiYXBpIiwiYXV0aG9yaXphdGlvbiIsImVkaXRQcm9maWxlRm9ybVZhbGlkYXRvciIsImFkZEltYWdlRm9ybVZhbGlkYXRvciIsImVkaXRQcm9maWxlUGljdHVyZUZvcm1WYWxpZGF0b3IiLCJlbmFibGVWYWxpZGF0aW9uIiwicHJvbWlzZUFsbCIsInVzZXIiLCJjYXJkRGF0YSIsInByb2ZpbGVJbmZvIiwic2V0VXNlckluZm8iLCJyZW5kZXJDYXJkIiwicmVuZGVySXRlbXMiLCJlcnJvciIsImFkZE5ld0ltYWdlRm9ybSIsImFkZE5ld0NhcmQiLCJzZXRFdmVudExpc3RlbmVycyIsImVkaXRVc2VySW5mb0Zvcm0iLCJ1c2VyRGF0YSIsInJlbmRlckxvYWRpbmciLCJlZGl0UHJvZmlsZUluZm8iLCJmaW5hbGx5IiwiZWRpdFVzZXJJbWFnZUZvcm0iLCJlZGl0UHJvZmlsZVBpY3R1cmUiLCJjYXJkU2hvd0ltYWdlIiwiZGVsZXRlQ29uZmlybWF0aW9uRm9ybSIsImNhcmQiLCJvcGVuIiwic2V0U3VibWl0IiwiZ2V0Q2FyZElkIiwiZGVsZXRlQ2FyZCIsImhhbmRsZURlbGV0ZUNhcmQiLCJpc0xpa2VkIiwicmVtb3ZlTGlrZSIsImhhbmRsZUxpa2VEYXRhIiwiYWRkTGlrZSIsImNhcmRFbGVtZW50IiwiZ2VuZXJhdGVDYXJkIiwiYWRkSXRlbSIsImdldFVzZXJJbmZvIiwicmVzZXRWYWxpZGF0aW9uIl0sInNvdXJjZVJvb3QiOiIifQ==